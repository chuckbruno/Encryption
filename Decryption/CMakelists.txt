cmake_minimum_required(VERSION 3.12)

# project(laplacian_deformer)

SET(MAYA_PLUGIN_NAME "myCoolPlugin")
SET(MAYA_DIRECTORY "C:/Program Files/Autodesk/Maya2023")
SET(MAYA_HEADERS_DIR "${MAYA_DIRECTORY}/include")
SET(ENCRY_HEADERS_DIR "${CMAKE_SOURCE_DIR}/Encryption")
SET(MAYA_LIBRARY_DIR "${MAYA_DIRECTORY}/lib")

SET(SOURCE_FILES
  main.cpp testCommand.h testCommand.cpp
)

source_group("" FILES ${SOURCE_FILES})

INCLUDE_DIRECTORIES(${MAYA_HEADERS_DIR} ${ENCRY_HEADERS_DIR})
# INCLUDE_DIRECTORIES(${ENCRY_HEADERS_DIR})
LINK_DIRECTORIES(${MAYA_LIBRARY_DIR})

SET(ZLIB_PATH "${CMAKE_SOURCE_DIR}/thirdParty/zlib/include")
SET(ZLIB_LIBRARY_DIR "${CMAKE_SOURCE_DIR}/thirdParty/zlib/lib")

INCLUDE_DIRECTORIES(${ZLIB_PATH})
# INCLUDE_DIRECTORIES(${ENCRY_HEADERS_DIR})
LINK_DIRECTORIES(${ZLIB_LIBRARY_DIR})

SET(LIBRARIES Foundation.lib OpenMaya.lib OpenMayaAnim.lib OpenMayaUI.lib)

SET(MAYA_DEFINITIONS _AFXDLL _MBCS NT_PLUGIN REQUIRE_IOSTREAM _BOOL)

ADD_LIBRARY(${MAYA_PLUGIN_NAME} SHARED ${SOURCE_FILES} "common.cpp"   "EncryptorEngine.cpp")
TARGET_LINK_LIBRARIES(${MAYA_PLUGIN_NAME} ${LIBRARIES})
TARGET_LINK_LIBRARIES(${MAYA_PLUGIN_NAME} zlibstat.lib)

SET_TARGET_PROPERTIES(${MAYA_PLUGIN_NAME} PROPERTIES COMPILE_DEFINITIONS "${MAYA_DEFINITIONS}")
SET_TARGET_PROPERTIES(${MAYA_PLUGIN_NAME} PROPERTIES OUTPUT_NAME "${MAYA_PLUGIN_NAME}")
SET_TARGET_PROPERTIES(${MAYA_PLUGIN_NAME} PROPERTIES SUFFIX ".mll")
SET_TARGET_PROPERTIES(${MAYA_PLUGIN_NAME} PROPERTIES CLEAN_DIRECT_OUTPUT 1)

SET_TARGET_PROPERTIES(${MAYA_PLUGIN_NAME} PROPERTIES LINK_FLAGS "/export:initializePlugin /export:uninitializePlugin")
